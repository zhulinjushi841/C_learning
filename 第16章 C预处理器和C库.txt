第16章 C预处理器和C库


16.5 文件包含：#include
当预处理器发现#include指令时，会查看后面的文件名并把文件的内容包含到当前文件中，也就是替换源文件中的#include指令。
这相当于把被包含文件的全部内容输入到源文件#include指令所在的位置。
在UNIX系统中，尖括号告诉预处理器在标准系统目录中查找该文件。双引号告诉预处理器首先在当前目录中(或者文件名中指定的其他目录)查找该文件，如果
没找到再查找标准系统目录。

16.5.2 使用头文件
头文件中最常用的形式如下。
1.明示常量
2.宏函数
3.函数声明
4.结构模板定义
5.类型定义

许多程序员都在程序中使用自己开发的标准头文件。如果开发一系列相关的函数或结构，那么这种方法就特别有用。
此外，还可以使用头文件声明外部变量供其他文件共享。
然后，可以在与源文件相关联的头文件中进行引用式声明：
extern int status;	//该变量具有文件作用域，在源代码文件
这行代码会出现在包含该头文件的文件中，这样使用该系列函数的文件都能够使用这个变量。

需要包含头文件的另一种情况是，使用具有文件作用域、内部链接和 const 限定符的变量或数组。
const防止值被意外修改，static 意味着每个包含该头文件的文件都获得一份副本。因此，不需要在一个文件中进行定义式声明，
在其他文件中进行引用式声明。

16.6.3 条件编译
可以使用其他指令创建条件编译(conditional compilation)。也就是说，可以使用这些指令告诉编译器根据编译时的条件执行
或忽略信息块。
1.#ifdef、#else 和 #endif指令

2.#ifndef指令
#ifndef指令与#ifdef指令的用法类似，也可以和#else、#endif一起使用，但是逻辑相反，#ifndef指令判断后面的标识符
是否是未定义的，常用于定义之前未定义的常量。
通常在包含多个头文件时，其中的文件可能包含了相同的宏定义。#ifndef指令可以防止相同的宏被重复定义。
在首次定义一个宏的头文件中使用#ifndef指令激活定义，随后在其他头文件中的定义都被忽略。
防止头文件被重复包含的命令如下：
#ifndef _STDIO_H
#define _STDIO_H
//省略了文件的内容
#endif
